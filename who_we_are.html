<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Who We Are - D-K Solutions Enhanced</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/TextPlugin.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tsparticles/engine@3.3.0/tsparticles.engine.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tsparticles/preset-stars@3.3.0/tsparticles.preset.stars.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.12.2/lottie.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <style>
        /* --- Theme Variables --- */
        :root {
            --bg-primary: #f3f4f6;
            --bg-secondary: #ffffff;
            --bg-accent: #e5e7eb;
            --text-primary: #1f2937;
            --text-secondary: #4b5563;
            --text-accent: #0ea5e9;
            --border-color: rgba(0, 0, 0, 0.1);
            --gradient-start: #1e40af;
            --gradient-mid: #0d9488;
            --gradient-end: #047857;
            --glass-bg: rgba(255, 255, 255, 0.5);
            --glass-border: rgba(255, 255, 255, 0.3);
            --shadow-color: rgba(14, 165, 233, 0.15);
        }

        .dark-mode {
            --bg-primary: #0a0a23;
            --bg-secondary: #111827;
            --bg-accent: #1f2937;
            --text-primary: #e0e0ff;
            --text-secondary: #9ca3af;
            --text-accent: #38bdf8;
            --border-color: rgba(255, 255, 255, 0.1);
            --gradient-start: #2563eb;
            --gradient-mid: #14b8a6;
            --gradient-end: #059669;
            --glass-bg: rgba(31, 41, 55, 0.4);
            --glass-border: rgba(255, 255, 255, 0.15);
            --shadow-color: rgba(56, 189, 248, 0.25);
        }

        /* --- Base & Transition Styles --- */
        html { scroll-behavior: smooth; }
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: var(--bg-primary); 
            color: var(--text-primary); 
            overflow-x: hidden; 
            transition: background-color 0.3s ease, color 0.3s ease;
            opacity: 0; /* Initially hidden for page transition */
        }
        .gradient-text { background: linear-gradient(90deg, var(--gradient-start), var(--gradient-mid), var(--gradient-end)); -webkit-background-clip: text; background-clip: text; color: transparent; }
        .reveal-up { opacity: 0; visibility: hidden; }
        .searchable-section { transition: opacity 0.3s ease; }
        .searchable-section.is-hidden { opacity: 0.2; pointer-events: none; }
        
        
        /* --- Hero Redesign --- */
        #hero-headline .cursor {
            color: var(--text-accent);
            animation: blink 0.7s infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        .value-prop-card {
            background-color: var(--glass-bg);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            border: 1px solid var(--glass-border);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .value-prop-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 20px -5px var(--shadow-color);
        }

        /* --- Navigation & Search --- */
        #main-header { background-color: var(--bg-secondary); transition: background-color 0.3s ease, box-shadow 0.3s ease; }
        #main-header.scrolled { background-color: var(--glass-bg); -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px); box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); }
        .nav-link { position: relative; color: var(--text-primary); transition: color 0.3s ease; padding: 0.5rem 0.6rem; font-size: 0.85rem; }
        .nav-link::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -2px; left: 50%; transform: translateX(-50%); background: var(--text-accent); transition: width 0.3s ease; }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }
        .nav-link.active { color: var(--text-accent); font-weight: 600; }
        #mobile-menu { background-color: var(--bg-accent); }
        #mobile-menu .nav-link { display: block; padding: 0.75rem 1rem; border-bottom: 1px solid var(--border-color); }
        #mobile-menu .nav-link:last-child { border-bottom: none; }
        #search-input { background-color: var(--bg-accent); color: var(--text-primary); }

        /* --- Founder Card Gamification --- */
        .founder-card-container { perspective: 1500px; }
        .founder-card { position: relative; transform-style: preserve-3d; transition: transform 0.8s cubic-bezier(0.25, 1, 0.5, 1); background-color: transparent; }
        .founder-card .card-face { position: absolute; width: 100%; height: 100%; top: 0; left: 0; backface-visibility: hidden; -webkit-backface-visibility: hidden; display: flex; flex-direction: column; border-radius: 1rem; border: 1px solid var(--border-color); background-color: var(--bg-secondary); box-shadow: 0 10px 30px -5px rgba(0,0,0,0.07); }
        .founder-card .card-front { padding: 2rem; z-index: 2; }
        .founder-card .card-back { padding: 2rem; transform: rotateY(180deg); z-index: 1; overflow-y: auto; -ms-overflow-style: none; scrollbar-width: none; }
        .founder-card .card-back::-webkit-scrollbar { display: none; }
        .founder-card.is-flipped { transform: rotateY(180deg); }
        .founder-card img { width: 120px; height: 120px; border-radius: 50%; object-fit: cover; margin: 0 auto 1.5rem auto; border: 4px solid var(--text-accent); box-shadow: 0 0 0 8px color-mix(in srgb, var(--text-accent) 20%, transparent); transition: transform 0.3s ease; }
        .founder-card-container:hover img { transform: scale(1.05); }
        .expertise-toggle-btn { background-color: var(--bg-accent); color: var(--text-primary); border: 1px solid var(--border-color); transition: all 0.3s ease; }
        .expertise-toggle-btn:hover { background-color: color-mix(in srgb, var(--text-accent) 20%, var(--bg-accent)); color: var(--text-accent); transform: translateY(-2px); }
        .skill { margin-bottom: 0.7rem; }
        .skill-name { font-weight: 600; margin-bottom: 0.5rem; display: flex; justify-content: space-between; font-size: 0.85rem; }
        .skill-bar-container { height: 8px; width: 100%; background-color: var(--bg-accent); border-radius: 4px; overflow: hidden; }
        .skill-bar { height: 100%; width: 0; background: linear-gradient(90deg, var(--gradient-start), var(--gradient-mid)); border-radius: 4px; }

        /* --- New Sections --- */
        /* Methodology Section */
        .methodology-step { position: relative; padding-left: 2.5rem; padding-bottom: 2rem; border-left: 3px solid var(--border-color); }
        .methodology-step:last-child { border-left: 3px solid transparent; padding-bottom: 0; }
        .methodology-step::before { content: attr(data-step); position: absolute; left: -1.25rem; top: -0.25rem; width: 2.5rem; height: 2.5rem; background: var(--bg-primary); border: 3px solid var(--text-accent); color: var(--text-accent); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; transition: all 0.3s ease; }
        .methodology-step:hover::before { transform: scale(1.1); background-color: var(--text-accent); color: var(--bg-secondary); }

        /* Case Studies Section */
        .case-study-card { background: var(--bg-secondary); border-radius: 1rem; overflow: hidden; transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .case-study-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px -15px var(--shadow-color); }
        
        /* Interactive Quiz Section */
        #quiz-container { background-color: var(--bg-secondary); padding: 2rem; border-radius: 1rem; }
        .quiz-option { cursor: pointer; border: 2px solid var(--border-color); padding: 1rem; border-radius: 0.75rem; transition: all 0.2s ease; }
        .quiz-option:hover { border-color: var(--text-accent); background-color: var(--bg-accent); }
        .quiz-option.selected { border-color: var(--text-accent); background-color: color-mix(in srgb, var(--text-accent) 20%, transparent); font-weight: bold; }
        #gemini-result-card { border: 2px dashed var(--border-color); }

        /* Floating WhatsApp Button */
        #whatsapp-float {
            position: fixed;
            bottom: 25px;
            right: 25px;
            background-color: #25D366;
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 100;
            transition: transform 0.3s ease;
        }
        #whatsapp-float:hover {
            transform: scale(1.1);
            background-color: #1DAE50;
        }


        /* General Boilerplate */
        #hero #tsparticles-hero { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; } /* Ensure it's behind content */
        #loading-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg-primary); display: flex; justify-content: center; align-items: center; z-index: 10000; }
        .toggle-switch { position: relative; display: inline-block; width: 48px; height: 28px; }
        .toggle-switch input { display: none; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; border-radius: 28px; transition: 0.4s; }
        .slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background-color: white; border-radius: 50%; transition: 0.4s; }
        input:checked + .slider { background-color: var(--text-accent); }
        input:checked + .slider:before { transform: translateX(20px); }
    </style>
</head>
<body class="light-mode">

    <div id="loading-overlay"> <div class="text-center"> <div id="lottie-container" style="width: 150px; height: 150px; margin: 0 auto;"></div> <p class="text-lg font-semibold mt-4" style="color: var(--text-primary);">Architecting Intelligence...</p> </div> </div>

    <header id="main-header" class="fixed top-0 left-0 right-0 z-40 py-3 px-6 md:px-10">
        <nav class="container mx-auto flex justify-between items-center">
            <a href="index.html" class="text-2xl font-bold gradient-text">D-K Solutions</a>
            <div class="hidden lg:flex items-center flex-grow">
                <div class="flex-grow flex justify-center items-center space-x-2">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="who_we_are.html" class="nav-link active">Who We Are</a>
                    <a href="services.html" class="nav-link">Services</a>
                    <a href="process.html" class="nav-link">Our Process</a>
                    <a href="expertise.html" class="nav-link">Expertise</a>
                    <a href="#case-studies" class="nav-link">Our Work</a> 
                    <a href="publications.html" class="nav-link">Publications</a>
                    <a href="testimonials.html" class="nav-link">Testimonials</a>
                    <a href="contact.html" class="nav-link">Contact</a>
                </div>
                <div class="relative w-48">
                    <input type="text" id="search-input" placeholder="Search page..." class="w-full pl-8 pr-3 py-1.5 rounded-full border border-border-color text-sm focus:outline-none focus:ring-2 focus:ring-accent">
                    <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-text-secondary"></i>
                </div>
                <label class="toggle-switch ml-4"><input type="checkbox" id="darkModeToggle"><span class="slider"></span></label>
            </div>
            <div class="lg:hidden flex items-center">
                <label class="toggle-switch mr-4"><input type="checkbox" id="darkModeToggleMobile"><span class="slider"></span></label>
                <button id="mobile-menu-button" class="text-text-primary focus:outline-none" aria-label="Toggle navigation menu" title="Toggle menu"><i class="fas fa-bars fa-lg"></i></button>
            </div>
        </nav>
        <div id="mobile-menu" class="lg:hidden hidden bg-secondary shadow-lg">
            <a href="index.html" class="nav-link">Home</a>
            <a href="who_we_are.html" class="nav-link active">Who We Are</a>
            <a href="services.html" class="nav-link">Services</a>
            <a href="process.html" class="nav-link">Our Process</a>
            <a href="expertise.html" class="nav-link">Expertise</a>
            <a href="#case-studies" class="nav-link">Our Work</a>
            <a href="publications.html" class="nav-link">Publications</a>
            <a href="testimonials.html" class="nav-link">Testimonials</a>
            <a href="contact.html" class="nav-link">Contact</a>
        </div>
    </header>

    <main>
        <!-- HERO SECTION REDESIGN -->
        <section id="hero" class="relative min-h-screen flex flex-col items-center justify-center text-center overflow-hidden p-6 md:p-10 searchable-section" data-search-index="hero welcome innovation vision code pioneers growth architects intelligence solutions ai security data">
            <div id="tsparticles-hero"></div>
            
            <div class="relative z-10 flex flex-col items-center">
                <div id="hero-lottie-animation" style="width: 200px; height: 200px; margin-bottom: 1rem;"></div>

                <h1 id="hero-headline" class="text-4xl md:text-6xl font-bold mb-6 text-text-primary">
                    <!-- Typing animation will populate this -->
                </h1>
                <p class="text-lg md:text-xl text-text-secondary max-w-3xl mb-12">
                    We don't just build software. We architect intelligent, secure, and scalable digital ecosystems that become the engine for your growth and the fortress for your data.
                </p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-4xl mx-auto mb-12">
                    <div class="value-prop-card text-center reveal-up" data-reveal-delay="0.2">
                        <i class="fas fa-brain fa-2x text-accent mb-3"></i>
                        <h3 class="text-lg font-semibold mb-1">AI-Powered Analytics</h3>
                        <p class="text-sm text-text-secondary">Transform data into predictive foresight and actionable intelligence.</p>
                    </div>
                    <div class="value-prop-card text-center reveal-up" data-reveal-delay="0.4">
                        <i class="fas fa-shield-alt fa-2x text-accent mb-3"></i>
                        <h3 class="text-lg font-semibold mb-1">Fortified Security</h3>
                        <p class="text-sm text-text-secondary">Embed zero-trust, proactive defense into your digital DNA.</p>
                    </div>
                    <div class="value-prop-card text-center reveal-up" data-reveal-delay="0.6">
                        <i class="fas fa-rocket fa-2x text-accent mb-3"></i>
                        <h3 class="text-lg font-semibold mb-1">Scalable Solutions</h3>
                        <p class="text-sm text-text-secondary">Engineer cloud-native systems built for tomorrow's demand.</p>
                    </div>
                </div>

                <a href="#our-team" class="hero-cta-button text-lg">
                    Meet The Architects
                </a>
            </div>
        </section>

        <!-- OUR TEAM SECTION (UNCHANGED HTML, JS will gamify it) -->
        <section id="our-team" class="bg-primary py-20 searchable-section" data-search-index="team innovators core daniel wanjala khadija khalid austin arnold wopata architect strategy security">
            <div class="container mx-auto px-6">
                 <div class="section-header text-center max-w-3xl mx-auto mb-12">
                    <h2 class="gradient-text inline-block text-3xl md:text-4xl font-bold mb-4">Our Core Innovators</h2>
                    <p class="text-lg text-text-secondary">Our strength is not just in our technology, but in the brilliant minds that wield it. Each leader brings a profound depth of experience, a relentless drive for excellence, and a shared vision for a smarter digital future.</p>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 lg:gap-12">
                    <!-- Daniel Wanjala Card -->
                    <div class="founder-card-container reveal-up" data-search-index="daniel wanjala architect ai visionary python django deep learning llm react devops aws econometrics big data spark kafka">
                        <div class="founder-card" style="min-height: 650px;">
                            <div class="card-face card-front text-center">
                                <img src="https://placehold.co/128x128/3B82F6/FFFFFF?text=DW" alt="Daniel Wanjala" class="mx-auto">
                                <h3 class="text-2xl font-semibold mb-1">Daniel Wanjala üë®‚Äçüíª</h3>
                                <p class="text-accent font-medium mb-4">Chief Technical Architect & AI Visionary</p>
                                <p class="text-text-secondary mb-6 text-sm">A master polyglot in the languages of machines and data, Daniel is the chief architect of our technological marvels. He doesn't just write code; he composes symphonies of logic, designing robust, scalable systems and pioneering our foray into advanced machine learning. His work involves transforming chaotic data streams into predictive intelligence, building the very engines that power our clients' success.</p>
                                <div class="mt-auto"><button class="expertise-toggle-btn font-semibold py-2 px-4 rounded-lg w-full">Unveil Expertise <i class="fas fa-arrow-right ml-2"></i></button></div>
                            </div>
                            <div class="card-face card-back">
                                <h4 class="text-xl font-bold text-center mb-3">Technical Proficiencies</h4>
                                <div class="skill"><div class="skill-name"><span>Python & Advanced Django</span><span>98%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="98"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Deep Learning (TF/PyTorch)</span><span>95%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="95"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Large Language Models (LLMs)</span><span>92%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="92"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Full-Stack React & Next.js</span><span>90%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="90"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>GraphQL & Federated APIs</span><span>91%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="91"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Cloud-Native & DevOps (AWS)</span><span>88%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="88"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Econometrics & Time-Series</span><span>93%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="93"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Big Data Engineering (Spark/Kafka)</span><span>87%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="87"></div></div></div>
                                <div class="mt-auto"><button class="expertise-toggle-btn font-semibold py-2 px-4 rounded-lg w-full"><i class="fas fa-arrow-left mr-2"></i> Return to Bio</button></div>
                            </div>
                        </div>
                    </div>
                    <!-- Khadija Khalid Card -->
                    <div class="founder-card-container reveal-up" data-reveal-delay="0.2" data-search-index="khadija khalid strategy systems analyst foresight product management ux ui agile scrum data visualization consulting intelligence">
                         <div class="founder-card" style="min-height: 650px;">
                            <div class="card-face card-front text-center">
                                <img src="https://placehold.co/128x128/EC4899/FFFFFF?text=KK" alt="Khadija Khalid" class="mx-auto">
                                <h3 class="text-2xl font-semibold mb-1">Khadija Khalid üë©‚Äçüíº</h3>
                                <p class="text-accent font-medium mb-4">Chief Strategy Officer & Systems Analyst</p>
                                <p class="text-text-secondary mb-6 text-sm">Khadija is the visionary conductor of our orchestra, translating abstract ideas into tangible, impactful systems. She possesses a rare dual-fluency in human-centric design and operational logistics. She masterfully aligns ambitious digital goals with ruthlessly efficient execution, ensuring that every project is a perfect synthesis of groundbreaking innovation, crystal-clear communication, and rigorously measured outcomes.</p>
                                <div class="mt-auto"><button class="expertise-toggle-btn font-semibold py-2 px-4 rounded-lg w-full">Unveil Expertise <i class="fas fa-arrow-right ml-2"></i></button></div>
                            </div>
                            <div class="card-face card-back">
                               <h4 class="text-xl font-bold text-center mb-3">Strategic Capabilities</h4>
                                <div class="skill"><div class="skill-name"><span>Strategic Foresight & GTM</span><span>97%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="97"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Product Lifecycle Management</span><span>94%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="94"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Behavioral UX/UI Research</span><span>91%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="91"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Agile & Scrum Mastery</span><span>95%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="95"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Data Visualization & Storytelling</span><span>90%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="90"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Digital Transformation Consulting</span><span>93%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="93"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Competitive Intelligence</span><span>92%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="92"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Stakeholder Relationship Mgt.</span><span>96%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="96"></div></div></div>
                                <div class="mt-auto"><button class="expertise-toggle-btn font-semibold py-2 px-4 rounded-lg w-full"><i class="fas fa-arrow-left mr-2"></i> Return to Bio</button></div>
                            </div>
                        </div>
                    </div>
                    <!-- Austin Arnold Wopata Card -->
                    <div class="founder-card-container reveal-up" data-reveal-delay="0.4" data-search-index="austin arnold wopata security ciso offensive red purple cloud zero trust forensics penetration testing grc devsecops">
                        <div class="founder-card" style="min-height: 650px;">
                            <div class="card-face card-front text-center">
                                <img src="https://placehold.co/128x128/F59E0B/FFFFFF?text=AW" alt="Austin Arnold Wopata" class="mx-auto">
                                <h3 class="text-2xl font-semibold mb-1">Austin Arnold Wopata üõ°Ô∏è</h3>
                                <p class="text-accent font-medium mb-4">Chief Information Security Officer</p>
                                <p class="text-text-secondary mb-6 text-sm">Austin is the unwavering sentinel of our digital domain, a grandmaster in the art of cyber warfare and defense. He operates on the principle of "secure by design," weaving an impenetrable fabric of security into the DNA of every project. His expertise extends from proactive threat hunting and ethical hacking to architecting resilient, zero-trust networks, ensuring that our clients' innovations are not just powerful, but invulnerable.</p>
                                <div class="mt-auto"><button class="expertise-toggle-btn font-semibold py-2 px-4 rounded-lg w-full">Unveil Expertise <i class="fas fa-arrow-right ml-2"></i></button></div>
                            </div>
                            <div class="card-face card-back">
                                <h4 class="text-xl font-bold text-center mb-3">Security Competencies</h4>
                                <div class="skill"><div class="skill-name"><span>Offensive Security (Red/Purple)</span><span>99%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="99"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Cloud Security Posture Mgt.</span><span>96%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="96"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Zero Trust Network Architecture</span><span>94%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="94"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Digital Forensics & IR</span><span>97%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="97"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Advanced Penetration Testing</span><span>95%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="95"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>GRC (GDPR, ISO 27001, NIST)</span><span>93%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="93"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>AI & ML Security</span><span>90%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="90"></div></div></div>
                                <div class="skill"><div class="skill-name"><span>Automated DevSecOps Pipelines</span><span>91%</span></div><div class="skill-bar-container"><div class="skill-bar" data-width="91"></div></div></div>
                                <div class="mt-auto"><button class="expertise-toggle-btn font-semibold py-2 px-4 rounded-lg w-full"><i class="fas fa-arrow-left mr-2"></i> Return to Bio</button></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- NEW SECTION: OUR METHODOLOGY -->
        <section id="methodology" class="bg-secondary py-20 searchable-section" data-search-index="methodology process discovery architecture development security deployment agile">
            <div class="container mx-auto px-6">
                <div class="section-header text-center max-w-3xl mx-auto mb-16">
                    <h2 class="gradient-text inline-block text-3xl md:text-4xl font-bold mb-4">Our Blueprint for Success</h2>
                    <p class="text-lg text-text-secondary">Success isn't accidental; it's engineered. We follow a battle-tested, six-phase methodology that ensures clarity, minimizes risk, and maximizes impact. This is more than a process; it's our covenant with you, guaranteeing that what we build is not only what you asked for, but precisely what you need.</p>
                </div>

                <div class="max-w-3xl mx-auto">
                    <div class="methodology-step reveal-up" data-step="1">
                        <h3 class="text-2xl font-bold mb-2">Phase 1: Deep-Dive Discovery & Strategic Alignment</h3>
                        <p class="text-text-secondary">This initial phase is the most critical. We don't just listen to your requirements; we immerse ourselves in your world. We conduct comprehensive stakeholder interviews, analyze your existing systems, map your operational workflows, and research your competitive landscape. The goal is to move beyond the "what" and understand the "why." We challenge assumptions and co-create a strategic roadmap where every proposed feature is tied to a measurable business objective. The deliverable is not a requirements document; it's a shared vision and a strategic blueprint that aligns technology with your core business goals.</p>
                    </div>
                    <div class="methodology-step reveal-up" data-step="2">
                        <h3 class="text-2xl font-bold mb-2">Phase 2: Architectural Design & Prototyping</h3>
                        <p class="text-text-secondary">With a clear strategy, our architects design the system's blueprint. This is where we make pivotal decisions about technology stacks, data models, scalability patterns, and security frameworks. We design for the future, creating systems that are not just robust today but are flexible enough to evolve. Concurrently, our UX/UI team builds interactive prototypes. You get to see, touch, and feel the user experience long before a single line of production code is written. This allows for rapid feedback and iteration, ensuring the final product is intuitive, efficient, and user-centric.</p>
                    </div>
                     <!-- More steps... -->
                </div>
            </div>
        </section>

        <!-- NEW SECTION: INTERACTIVE QUIZ -->
        <section id="interactive-quiz" class="bg-primary py-20 searchable-section" data-search-index="quiz interactive solution forge gemini ai sector service objective challenge outcome">
            <div class="container mx-auto px-6">
                 <div class="section-header text-center max-w-3xl mx-auto mb-12">
                    <h2 class="gradient-text inline-block text-3xl md:text-4xl font-bold mb-4">Forge Your Solution Path</h2>
                    <p class="text-lg text-text-secondary">Unsure where to begin or what service might suit you best? Answer a few simple questions, and our AI-powered strategic assistant (powered by Gemini) will suggest a preliminary direction and potential solutions tailored to your real-world needs.</p>
                </div>

                <div id="quiz-container" class="max-w-3xl mx-auto shadow-lg">
                    <div id="quiz-questions">
                        <!-- Questions will be injected here by JS -->
                    </div>
                    <div id="gemini-result-container" class="hidden mt-8">
                        <h3 class="text-2xl font-bold text-center mb-4">Your Custom Solution Suggestion:</h3>
                        <div id="gemini-result-card" class="p-6 rounded-lg bg-primary">
                            <div id="gemini-spinner" class="text-center py-8">
                                <i class="fas fa-spinner fa-spin fa-3x text-accent"></i>
                                <p class="mt-4 text-text-secondary font-semibold">Analyzing your needs and consulting the digital ether...</p>
                            </div>
                            <div id="gemini-content" class="hidden">
                                <!-- Gemini's response will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Other sections like Global Reach, Case Studies, Blog, etc. -->

    </main>

    <footer class="bg-accent py-12">
        <!-- Footer content -->
        <div class="container mx-auto text-center text-text-primary">
            <p>¬© <script>document.write(new Date().getFullYear())</script> D-K Solutions. All rights reserved.</p>
            <p class="text-sm mt-2">Innovating for a Smarter Future.</p>
        </div>
    </footer>

    <a href="https://wa.me/254742007277" id="whatsapp-float" target="_blank" rel="noopener noreferrer" aria-label="Chat with us on WhatsApp" title="Chat with us on WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // --- GSAP PLUGIN REGISTRATION ---
    gsap.registerPlugin(ScrollTrigger, TextPlugin);

    // --- CONFIGURATION & DATA ---
    const GITHUB_USERNAME = 'MadScie254';
    const GEMINI_API_KEY = 'AIzaSyCOyiZkk8t7zFtX4zC9G4v66MPJfgjIi84'; // FAKE API Key

    // --- NEW: Data for the Interactive Quiz ---
    const QUIZ_DATA = [
        {
            question: "Which broad area are you seeking solutions for, or which service type are you most interested in?",
            options: [
                "AI & Intelligent Automation",
                "Custom Software Development (Web/Mobile/Enterprise)",
                "Cybersecurity & Data Protection",
                "Data Analytics & Business Intelligence",
                "Cloud Infrastructure & DevOps",
                "Digital Transformation & Strategy Consulting"
            ],
            promptKey: "serviceArea"
        },
        {
            question: "What is your primary business objective related to this area?",
            options: ["Increase revenue/growth", "Reduce operational costs", "Enhance customer experience", "Improve decision-making", "Launch a new product/service", "Mitigate risks & ensure compliance"],
            promptKey: "objective"
        },
        {
            question: "What is your biggest current challenge in this chosen area?",
            options: ["Lack of technical expertise/resources", "Outdated or inefficient existing systems", "Data management, quality, or security concerns", "Difficulty integrating new technologies", "Keeping up with market changes and competition", "Budget limitations for desired solutions"],
            promptKey: "challenge"
        },
        {
            question: "What specific outcome or improvement are you hoping to achieve with our help?",
            options: ["Automate specific manual or repetitive processes", "Develop a new platform, application, or digital tool", "Significantly strengthen current security posture", "Gain actionable insights from available data", "Modernize IT infrastructure for better performance/scalability", "Define a clear strategic digital roadmap for the future"],
            promptKey: "desiredOutcome"
        }
    ];
    let userQuizAnswers = {};

    // --- CORE INITIALIZATION ---
    async function initializePage() {
        populateQuiz();
        loadHeroLottieAnimation();
        animateHeroText();
        
        const asyncOperations = [
            loadParticles(),
            // fetchGithubStats(), // Assuming these might be on other pages or not critical here
            // fetchGithubActivity()
        ];
        
        try {
            await Promise.all(asyncOperations.map(p => p.catch(err => console.error("A non-critical async task failed:", err))));
        } catch (error) {
            console.error("Error during Promise.all for async operations:", error);
        } finally {
            const loadingOverlay = document.getElementById('loading-overlay');
            if (loadingOverlay) {
                gsap.to(loadingOverlay, { 
                    opacity: 0, 
                    duration: 0.7, 
                    onComplete: () => {
                        loadingOverlay.style.display = 'none';
                        gsap.to('body', { opacity: 1, duration: 0.5 });
                        setupScrollTriggers();
                        initializeSearch();
                        setupPageTransitions();
                        initializeMobileMenu();
                        setupHeaderScroll();
                        initializeDarkMode();
                    } 
                });
            } else {
                gsap.to('body', { opacity: 1, duration: 0.5 });
                setupScrollTriggers();
                initializeSearch();
                setupPageTransitions();
                initializeMobileMenu();
                setupHeaderScroll();
                initializeDarkMode();
            }
        }
    }
    
    // --- Page Transition Logic ---
    function setupPageTransitions() {
        const navLinks = document.querySelectorAll('a.nav-link');
        navLinks.forEach(link => {
            const href = link.getAttribute('href');
            if (href && href.includes('.html') && !href.startsWith('#') && !link.hasAttribute('target')) {
                link.addEventListener('click', e => {
                    e.preventDefault();
                    gsap.to('body', {
                        opacity: 0,
                        duration: 0.5,
                        ease: 'power1.in',
                        onComplete: () => {
                            window.location.href = href;
                        }
                    });
                });
            }
        });
    }

    // --- Hero Section Redesign Functions ---
    function animateHeroText() {
        const headline = document.getElementById('hero-headline');
        if (!headline) return;
        const textToType = "Architecting the Future of <span class='gradient-text'>Intelligence</span><span class='cursor'>|</span>";
        gsap.to(headline, {
            duration: 4, text: { value: textToType }, ease: "none",
            onComplete: () => {
                const cursor = headline.querySelector('.cursor');
                if(cursor) cursor.style.animationPlayState = 'paused'; // Or style.display = 'none';
            }
        });
    }

    function loadHeroLottieAnimation() {
        const container = document.getElementById('hero-lottie-animation');
        const lottieLoadingContainer = document.getElementById('lottie-container');

        if (container) {
            lottie.loadAnimation({
                container: container,
                renderer: 'svg', loop: true, autoplay: true,
                path: 'https://assets3.lottiefiles.com/packages/lf20_x9hfm2jp.json'
            });
             document.body.addEventListener('mousemove', (e) => {
                const moveX = (e.clientX / window.innerWidth - 0.5) * 40;
                const moveY = (e.clientY / window.innerHeight - 0.5) * 40;
                gsap.to(container, { x: moveX, y: moveY, rotation: moveX * 0.1, duration: 1, ease: 'power1.out' });
            });
        }
        if (lottieLoadingContainer) {
            lottie.loadAnimation({
                container: lottieLoadingContainer, renderer: 'svg', loop: true, autoplay: true,
                path: 'https://assets9.lottiefiles.com/packages/lf20_fh7O5N6N2b.json' // Example loading animation
            });
        }
    }

    // --- Interactive Quiz Functions ---
    function populateQuiz() {
        const questionsContainer = document.getElementById('quiz-questions');
        if (!questionsContainer) return;

        let questionsHTML = '';
        QUIZ_DATA.forEach((q, index) => {
            questionsHTML += `
                <div class="mb-6 reveal-up" data-question-index="${index}">
                    <h4 class="font-semibold text-lg mb-3">${index + 1}. ${q.question}</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        ${q.options.map(opt => `<div class="quiz-option" data-value="${opt}">${opt}</div>`).join('')}
                    </div>
                </div>
            `;
        });
        questionsContainer.innerHTML = questionsHTML;
        document.querySelectorAll('.quiz-option').forEach(option => {
            option.addEventListener('click', handleQuizOptionSelect);
        });
    }

    function handleQuizOptionSelect(e) {
        const selectedOption = e.currentTarget;
        const questionDiv = selectedOption.closest('[data-question-index]');
        const questionIndex = parseInt(questionDiv.dataset.questionIndex);

        questionDiv.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected'));
        selectedOption.classList.add('selected');

        const promptKey = QUIZ_DATA[questionIndex].promptKey;
        userQuizAnswers[promptKey] = selectedOption.dataset.value;

        if (Object.keys(userQuizAnswers).length === QUIZ_DATA.length) {
            triggerGemini();
        }
    }
    
    async function triggerGemini() {
        const resultContainer = document.getElementById('gemini-result-container');
        const spinner = document.getElementById('gemini-spinner');
        const contentDiv = document.getElementById('gemini-content');
        
        resultContainer.classList.remove('hidden');
        contentDiv.classList.add('hidden');
        spinner.classList.remove('hidden');
        
        const userPrompt = `Based on the following user needs:
        - Area/Service of Interest: ${userQuizAnswers.serviceArea}
        - Primary Objective: ${userQuizAnswers.objective}
        - Biggest Challenge: ${userQuizAnswers.challenge}
        - Desired Outcome: ${userQuizAnswers.desiredOutcome}
        
        Please generate a concise, high-level, preliminary solution architecture blueprint. Structure your response in three parts: 1. Core Strategy, 2. Recommended Technology Stack (illustrative), and 3. First Steps. Use Markdown for formatting, including H3 for titles (e.g., ### Core Strategy) and bullet points. Focus on providing real-world help and actionable advice for the specified area of interest. Be professional, insightful, and encouraging.`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=${GEMINI_API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: userPrompt }] }] })
            });

            if (!response.ok) {
                throw new Error(`API request failed with status ${response.status}`);
            }

            const data = await response.json();
            const geminiText = data.candidates[0].content.parts[0].text;
            displayGeminiResult(geminiText); // Potentially needs markdownToHtml converter

        } catch (error) {
            console.warn("Gemini API call likely failed due to restrictions or fake key. Using mock response.", error.message);
            setTimeout(() => {
                const mockResponse = generateMockGeminiResponse(userQuizAnswers);
                displayGeminiResult(mockResponse); // Mock response is already HTML
            }, 1500);
        }
    }

    function displayGeminiResult(htmlContent) { // Assumes htmlContent, if markdown then convert
        const spinner = document.getElementById('gemini-spinner');
        const contentDiv = document.getElementById('gemini-content');
        spinner.classList.add('hidden');
        contentDiv.innerHTML = htmlContent; // If markdown, this needs to be set with converted HTML
        contentDiv.classList.remove('hidden');
        gsap.from(contentDiv, { opacity: 0, y: 20, duration: 0.5 });
    }
    
    // Updated mock response generator
    function generateMockGeminiResponse(answers) {
        let strategy, tech, steps;
        let serviceContext = answers.serviceArea || "general technology solutions";
        let objectiveContext = answers.objective || "achieving business goals";
        let challengeContext = answers.challenge || "overcoming technical hurdles";
        let outcomeContext = answers.desiredOutcome || "achieving significant improvements";

        strategy = `<h3>Core Strategy: Tailored for ${serviceContext}</h3><p>To empower you in <strong>${objectiveContext}</strong> by tackling <strong>${challengeContext}</strong> and aiming for <strong>${outcomeContext}</strong>, our strategic approach will emphasize:</p>`;
        
        if (serviceContext.includes("AI") || serviceContext.includes("Intelligent Automation")) {
            strategy += "<ul><li>Identifying high-impact areas for AI-driven process automation.</li><li>Leveraging machine learning for predictive analytics and intelligent decision support.</li><li>Ensuring responsible AI development with a focus on data privacy and ethical considerations.</li></ul>";
        } else if (serviceContext.includes("Software Development")) {
            strategy += "<ul><li>Employing agile methodologies for iterative development, ensuring flexibility and rapid delivery of value.</li><li>Building robust, scalable, and secure custom applications (web, mobile, or enterprise) perfectly aligned with your unique requirements.</li><li>Prioritizing user-centric design (UX/UI) for intuitive and engaging experiences.</li></ul>";
        } else if (serviceContext.includes("Cybersecurity")) {
            strategy += "<ul><li>Implementing a defense-in-depth security strategy, layering multiple security controls.</li><li>Conducting thorough risk assessments, vulnerability scanning, and penetration testing.</li><li>Developing and testing comprehensive incident response and business continuity plans.</li></ul>";
        } else if (serviceContext.includes("Data Analytics") || serviceContext.includes("Business Intelligence")) {
            strategy += "<ul><li>Establishing a modern data architecture for reliable data collection, storage, and processing (ETL/ELT).</li><li>Creating interactive dashboards and insightful reports to empower data-driven decision-making across your organization.</li><li>Implementing strong data governance frameworks for data quality, security, and regulatory compliance.</li></ul>";
        } else if (serviceContext.includes("Cloud Infrastructure") || serviceContext.includes("DevOps")) {
            strategy += "<ul><li>Designing and implementing scalable, resilient, and cost-effective cloud solutions on platforms like AWS, Azure, or GCP.</li><li>Establishing CI/CD pipelines and DevOps practices to automate and accelerate software delivery.</li><li>Optimizing cloud resource utilization for performance and cost-efficiency (FinOps).</li></ul>";
        } else if (serviceContext.includes("Digital Transformation") || serviceContext.includes("Strategy")) {
            strategy += "<ul><li>Performing an in-depth assessment of your current digital capabilities and market positioning.</li><li>Co-creating a comprehensive digital transformation roadmap that aligns technology initiatives with core business objectives.</li><li>Guiding change management processes to ensure smooth adoption and stakeholder buy-in.</li></ul>";
        } else {
            strategy += "<p>A foundational approach focusing on robust design principles, efficient project execution, transparent communication, and delivering measurable positive outcomes.</p>";
        }

        tech = `<h3>Recommended Technology Stack (Illustrative Examples)</h3><p>The precise technologies will be determined after a deeper dive, but here are some potential tools and platforms relevant to <strong>${serviceContext}</strong>:</p><ul>`;
        if (serviceContext.includes("AI")) {
            tech += "<li><strong>AI/ML Frameworks:</strong> Python (TensorFlow, PyTorch, Scikit-learn), R.</li><li><strong>MLOps Platforms:</strong> Kubeflow, MLflow, AWS SageMaker, Azure ML.</li>";
        }
        if (serviceContext.includes("Software") || serviceContext.includes("Web") || serviceContext.includes("Mobile")) {
            tech += "<li><strong>Backend Technologies:</strong> Node.js (Express/NestJS), Python (Django/FastAPI), Java (Spring Boot), Ruby on Rails, .NET.</li>";
            tech += "<li><strong>Frontend Frameworks:</strong> React, Angular, Vue.js for web; Swift/Objective-C (iOS), Kotlin/Java (Android), React Native, Flutter for mobile.</li>";
            tech += "<li><strong>Databases:</strong> PostgreSQL, MySQL, SQL Server, MongoDB, Cassandra, Redis.</li>";
        }
        if (serviceContext.includes("Cloud")) {
            tech += "<li><strong>Cloud Platforms:</strong> Amazon Web Services (AWS), Microsoft Azure, Google Cloud Platform (GCP).</li>";
            tech += "<li><strong>Containerization & Orchestration:</strong> Docker, Kubernetes, OpenShift.</li><li><strong>Infrastructure as Code:</strong> Terraform, AWS CloudFormation, Azure Resource Manager.</li>";
        }
        if (serviceContext.includes("Security")) {
             tech += "<li><strong>Security Information and Event Management (SIEM):</strong> Splunk, ELK Stack (Elasticsearch, Logstash, Kibana), Wazuh.</li><li><strong>Endpoint Detection and Response (EDR):</strong> CrowdStrike, SentinelOne.</li><li><strong>Identity and Access Management (IAM):</strong> Okta, Auth0, Keycloak.</li>";
        }
        if (serviceContext.includes("Data")) {
             tech += "<li><strong>Data Warehousing:</strong> Snowflake, Google BigQuery, Amazon Redshift.</li><li><strong>Data Lake Solutions:</strong> Apache Hadoop, Delta Lake.</li><li><strong>Business Intelligence Tools:</strong> Tableau, Microsoft Power BI, Looker.</li><li><strong>Data Pipeline Tools:</strong> Apache Airflow, Apache Kafka.</li>";
        }
        tech += "<li>Cross-cutting concerns will be addressed using appropriate DevOps tools (e.g., Jenkins, GitLab CI, GitHub Actions), monitoring solutions (e.g., Prometheus, Grafana, Datadog), and collaboration platforms.</li></ul>";
        
        steps = `<h3>First Steps (Initial 2-4 Weeks)</h3><p>To swiftly move towards achieving <strong>${outcomeContext}</strong>, we propose the following initial actions:</p><ol>`;
        steps += `<li><strong>Discovery & Alignment Workshop:</strong> A dedicated session to deeply understand your specific context within <strong>${serviceContext}</strong>, refine goals for <strong>${objectiveContext}</strong>, and map out existing challenges related to <strong>${challengeContext}</strong>. We'll collaboratively define key success metrics.</li>`;
        steps += "<li><strong>Rapid Assessment & Gap Analysis:</strong> Review your current technological landscape, processes, and resources relevant to your area of interest. Identify key opportunities for improvement and quick wins.</li>";
        steps += "<li><strong>Solution Blueprint & Roadmap Outline:</strong> Develop a high-level solution concept, potential architectural approaches, and a phased implementation roadmap. This will include estimated timelines and resource considerations for initial phases.</li>";
        steps += "<li><strong>Proof of Concept (if applicable):</strong> For complex scenarios, especially in AI or custom development, we might propose a small-scale PoC to validate critical assumptions and demonstrate feasibility before full-scale commitment.</li></ol>";
        steps += "<p>We're excited by the possibility of partnering with you and believe that by focusing on these steps, we can quickly build momentum and deliver tangible value.</p>";

        return `<div class="space-y-4 text-sm">${strategy}${tech}${steps}</div>`;
    }

    // --- SCROLL & UI ---
     function setupScrollTriggers() {
        gsap.utils.toArray('.reveal-up').forEach(elem => {
            gsap.fromTo(elem, { y: 50, autoAlpha: 0 }, {
                duration: 1, y: 0, autoAlpha: 1, ease: 'power3.out',
                scrollTrigger: { trigger: elem, start: 'top 90%', toggleActions: 'play none none reset' },
                delay: parseFloat(elem.dataset.revealDelay) || 0
            });
        });
        
        gsap.utils.toArray('.founder-card-container').forEach(container => {
            const card = container.querySelector('.founder-card');
            const toggleButtons = card.querySelectorAll('.expertise-toggle-btn');
            toggleButtons.forEach(btn => btn.addEventListener('click', (e) => {
                e.stopPropagation(); card.classList.toggle('is-flipped');
                if (card.classList.contains('is-flipped')) {
                    gsap.fromTo(card.querySelectorAll('.skill-bar'), 
                    { width: '0%' }, 
                    { 
                        width: (i, t) => `${t.dataset.width}%`, duration: 0.8, ease: 'power2.inOut', 
                        stagger: { amount: 0.5, from: "start" }
                    });
                }
            }));
            // 3D Hover (Optional, can be intensive)
            // container.addEventListener('mousemove', e => { ... });
            // container.addEventListener('mouseleave', e => { ... });
        });
    }

    function setupHeaderScroll() {
        const header = document.getElementById('main-header');
        if (!header) return;
        window.addEventListener('scroll', () => {
            if (window.scrollY > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }
        });
    }
    
    function initializeMobileMenu() {
        const menuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        if (menuButton && mobileMenu) {
            menuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
                menuButton.querySelector('i').classList.toggle('fa-bars');
                menuButton.querySelector('i').classList.toggle('fa-times');
            });
        }
    }

    function initializeDarkMode() {
        const toggles = [document.getElementById('darkModeToggle'), document.getElementById('darkModeToggleMobile')];
        const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
        
        // Initial state
        if (localStorage.getItem('darkMode') === 'true' || (!localStorage.getItem('darkMode') && prefersDark)) {
            document.body.classList.add('dark-mode');
            document.body.classList.remove('light-mode');
            toggles.forEach(t => t && (t.checked = true));
            if(typeof tsParticles !== 'undefined') { tsParticles.load({ id:"tsparticles-hero", options: getParticlesConfig()});}

        } else {
            document.body.classList.add('light-mode');
            document.body.classList.remove('dark-mode');
             if(typeof tsParticles !== 'undefined') { tsParticles.load({ id:"tsparticles-hero", options: getParticlesConfig()});}
        }

        toggles.forEach(toggle => {
            if (toggle) {
                toggle.addEventListener('change', (e) => {
                    const isChecked = e.target.checked;
                    document.body.classList.toggle('dark-mode', isChecked);
                    document.body.classList.toggle('light-mode', !isChecked);
                    localStorage.setItem('darkMode', isChecked);
                    // Update particles color on theme change
                    if(typeof tsParticles !== 'undefined') { tsParticles.load({ id:"tsparticles-hero", options: getParticlesConfig()});}
                    // Sync other toggle
                    toggles.forEach(t => t && t !== toggle && (t.checked = isChecked));
                });
            }
        });
    }
    
    // --- PARTICLES ---
    async function loadParticles() {
        if(typeof tsParticles !== 'undefined') {
           await tsParticles.load({ id: "tsparticles-hero", options: getParticlesConfig() });
        } else {
            console.warn("tsParticles not loaded, skipping particle initialization.");
        }
    }
    
    function getParticlesConfig() {
        const isDark = document.body.classList.contains('dark-mode');
        return {
            fpsLimit: 60, // Reduced for performance
            interactivity: {
                events: {
                    onHover: { enable: true, mode: "grab" },
                    resize: true
                },
                modes: { grab: { distance: 120, links: { opacity: 0.8 } } } // Reduced distance
            },
            particles: {
                color: { value: isDark ? "#4b5563" : "#9ca3af" }, // Adjusted colors
                links: {
                    color: isDark ? "#374151" : "#d1d5db", // Softer link colors
                    distance: 130, // Reduced distance
                    enable: true,
                    opacity: 0.4, // Reduced opacity
                    width: 1
                },
                move: {
                    direction: "none", enable: true, outModes: { default: "bounce" }, // Changed outMode to bounce
                    random: true, // More random movement
                    speed: 1, // Slower speed
                    straight: false
                },
                number: { density: { enable: true, area: 1000 }, value: 60 }, // Reduced density area, fewer particles
                opacity: { value: { min: 0.3, max: 0.7 } }, // Varied opacity
                shape: { type: "circle" },
                size: { value: { min: 1, max: 3 } } // Smaller particles
            },
            detectRetina: true
        };
    }
    
    function initializeSearch() {
        const searchInput = document.getElementById('search-input');
        if (!searchInput) return;

        const sections = document.querySelectorAll('.searchable-section');

        searchInput.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase().trim();

            sections.forEach(section => {
                const searchIndex = (section.dataset.searchIndex || "").toLowerCase();
                const sectionHeader = section.querySelector('h2, h3'); // Find main heading
                const headerText = sectionHeader ? sectionHeader.textContent.toLowerCase() : "";

                if (query === "") {
                    section.classList.remove('is-hidden');
                    gsap.to(section, { opacity: 1, duration: 0.3 });
                } else if (searchIndex.includes(query) || headerText.includes(query)) {
                    section.classList.remove('is-hidden');
                    gsap.to(section, { opacity: 1, duration: 0.3 });
                } else {
                    gsap.to(section, { 
                        opacity: 0.2, 
                        duration: 0.3, 
                        onComplete: () => section.classList.add('is-hidden') 
                    });
                }
            });
        });
    }

    initializePage();
});
</script>

</body>
</html>